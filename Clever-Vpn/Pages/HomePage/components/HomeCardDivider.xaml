<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Clever_Vpn.Pages.HomePage.components.HomeCardDivider"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Clever_Vpn.Pages.HomePage.components"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:triggers="using:CommunityToolkit.WinUI"
    xmlns:vm="using:Clever_Vpn.ViewModel"
    xmlns:vpn="using:Clever_Vpn_Windows_Kit.Data"
    mc:Ignorable="d"
    Loaded="UserControl_Loaded"
    Unloaded="UserControl_Unloaded">


    <Grid  Height="40" Margin="10,0">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="VpnUp">
                    <VisualState.StateTriggers>
                        <triggers:IsEqualStateTrigger                             
                            Value="{x:Bind  Vm.VpnState, Mode=OneWay}"
                            To="{x:Bind vpn:CleverVpnState.Up }" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="StateTextBorder.BorderBrush" Value="ForestGreen" />
                        <Setter Target="StateTextBlock.Foreground" Value="ForestGreen" />

                        <Setter Target="StateTextGrid.Visibility" Value="Visible" />
                        <Setter Target="ProgressBar.Visibility" Value="Collapsed" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="VpnDown" >
                    <VisualState.StateTriggers>
                        <triggers:IsEqualStateTrigger                             
                            Value="{x:Bind  Vm.VpnState, Mode=OneWay}"
                            To="{x:Bind vpn:CleverVpnState.Down }" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="StateTextBorder.BorderBrush" Value="Gray" />
                        <Setter Target="StateTextBlock.Foreground" Value="Gray" />
                        <Setter Target="StateTextGrid.Visibility" Value="Visible" />
                        <Setter Target="ProgressBar.Visibility" Value="Collapsed" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="VpnConnecting" >
                    <VisualState.StateTriggers>
                        <triggers:IsEqualStateTrigger                             
                            Value="{x:Bind  Vm.VpnState, Mode=OneWay}"
                            To="{x:Bind vpn:CleverVpnState.Connecting }" />
                        <triggers:IsEqualStateTrigger                             
                            Value="{x:Bind  Vm.VpnState, Mode=OneWay}"
                            To="{x:Bind vpn:CleverVpnState.Reconnecting }" />
                        <triggers:IsEqualStateTrigger                             
                            Value="{x:Bind  Vm.VpnState, Mode=OneWay}"
                            To="{x:Bind vpn:CleverVpnState.Disconnecting }" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="StateTextGrid.Visibility" Value="Collapsed" />
                        <Setter Target="ProgressBar.Visibility" Value="Visible" />

                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Grid x:Name="StateTextGrid" 
            VerticalAlignment="Center"
            ColumnSpacing="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Rectangle
                Grid.Column="0"
                Height="2"
                Fill="Gray"
                VerticalAlignment="Center" />

            <Border x:Name="StateTextBorder"
                Grid.Column="1"
                BorderBrush="ForestGreen"
                BorderThickness="2"
                CornerRadius="20"
                Padding="16,8"
                VerticalAlignment="Center">
                <TextBlock
                    x:Name="StateTextBlock"
                    Text="{x:Bind GetStateText(Vm.VpnState), Mode=OneWay}"
                    FontSize="12"
                    Foreground="ForestGreen"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"/>
            </Border>

            <Rectangle
                Grid.Column="2"
                Height="2"
                Fill="Gray"
                VerticalAlignment="Center" />
        </Grid>
        <ProgressBar x:Name="ProgressBar"
            Height="4"
            IsIndeterminate="True"
            HorizontalAlignment="Stretch"
            Margin="0,20,0,0" />

    </Grid>
</UserControl>
